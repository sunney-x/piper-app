(this.webpackJsonppiper=this.webpackJsonppiper||[]).push([[0],{183:function(e,t){},185:function(e,t){},196:function(e,t){},198:function(e,t){},225:function(e,t){},227:function(e,t){},228:function(e,t){},233:function(e,t){},235:function(e,t){},241:function(e,t){},243:function(e,t){},262:function(e,t){},274:function(e,t){},277:function(e,t){},332:function(e,t,n){},333:function(e,t,n){},337:function(e,t,n){"use strict";n.r(t);var c,a,r=n(0),s=n.n(r),o=n(166),i=n.n(o),u=n(27),d=n(5),l=n(22),j=(n(167),n(1)),p=Object(r.createContext)({user:{id:"",name:"",avatar:""},signup:function(){}}),m=function(){return Object(r.useContext)(p)},b=function(e){var t=h();return Object(j.jsx)(p.Provider,{value:t,children:e.children})},h=function(){var e=Object(r.useState)({id:"",name:"Guest",avatar:""}),t=Object(l.a)(e,2),n=t[0],c=t[1],a=function(e){var t=Math.random().toString(36).substr(2,9),n={id:t,name:e||"Guest",avatar:"https://avatars.dicebear.com/api/avataaars/".concat(e||t,".svg")};localStorage.setItem("user",JSON.stringify(n)),c(n)};return Object(r.useEffect)((function(){var e=localStorage.getItem("user");if(e){var t=JSON.parse(e);c(t)}else a()}),[]),{user:n,signup:a}},O=n.p+"static/media/checkmark.f9034358.svg",f=n(57),x=n(58),v=x.a.div(c||(c=Object(f.a)(["\n  margin: 0;\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n"]))),g=function(){var e,t=m();return Object(j.jsx)("div",{style:{fontSize:"1.5em",display:"flex"},children:Object(j.jsxs)(v,{style:{width:"80%",display:"flex",justifyContent:"center"},children:[Object(j.jsx)("input",{onChange:function(t){return e=t.target.value},type:"text",placeholder:"Username",style:{borderRadius:"50px",fontSize:"1em",padding:"15px",paddingLeft:"30px",outline:"none",border:"none"}}),Object(j.jsx)(u.b,{to:"/",children:Object(j.jsx)("button",{onClick:function(){return t.signup(e)},style:{marginLeft:"25px",borderRadius:"50px",width:"9em",height:"7em",border:"none",backgroundColor:"#41F900",cursor:"pointer"},children:Object(j.jsx)("img",{src:O,alt:"Checkmark"})})})]})})},y=n(37),N=n(174),w=n(19),I=n(36),S=n.n(I),z=n(172),k=x.a.button(a||(a=Object(f.a)(["\n  background-color: #f5f5f5;\n  border: 1px solid #e0e0e0;\n  border-radius: 15px;\n  color: #333;\n  cursor: pointer;\n  font-size: 20px;\n  font-weight: bold;\n  padding: 10px;\n  text-align: center;\n  text-decoration: none;\n  outline: 0;\n  -webkit-appearance: none;\n  -moz-appearance: none;\n  appearance: none;\n\n  &:hover {\n    background-color: #e5e5e5;\n    color: #333;\n  }\n"]))),E=n.p+"static/media/airplane.bf7fe13f.svg",T=function(e){var t=e.messages,n=t[0].author;return Object(j.jsxs)("div",{className:"grouped-chat-messages",children:[Object(j.jsx)("img",{src:null===n||void 0===n?void 0:n.avatar,className:"chat-messages-author-avatar owner",alt:"Avatar of ".concat(n.name)}),Object(j.jsxs)("div",{className:"chat-messages",children:[Object(j.jsx)("div",{className:"grouped-chat-messages-meta",children:Object(j.jsx)("p",{className:"chat-messages-author-name",children:t[0].author.name})}),t.map((function(e){return Object(j.jsx)("div",{className:"chat-message",children:Object(j.jsx)("p",{className:"chat-message-content",children:e.content})})}))]})]})},M=function(e){var t=Object(r.useRef)(null);if(Object(r.useEffect)((function(){t.current&&(t.current.scrollTop=t.current.scrollHeight)})),!e.messages)return Object(j.jsx)(j.Fragment,{});var n=function(e,t){for(var n=[],c=0,a=0;a<e.length;a++)a?e[a-1][t]!==e[a][t]&&(n[++c]=[]):n[c]=[],n[c].push(e[a]);return n}(e.messages,"authorId");return Object(j.jsxs)("div",{className:"chat",style:{width:"22%"},children:[Object(j.jsxs)("div",{className:"grouped-chat-messages-wrapper",style:{overflowY:"auto"},ref:t,children:[n.map((function(e){return Object(j.jsx)(T,{messages:e})})),Object(j.jsx)("div",{className:"ps__rail-y",style:{top:"182px",right:"0px",height:"426px"},children:Object(j.jsx)("div",{className:"ps__thumb-y",tabIndex:0,style:{top:"128px",height:"298px"}})})]}),Object(j.jsxs)("div",{className:"chat-bar-wrapper",children:[Object(j.jsx)("input",{type:"text",placeholder:"Say something cool...",className:"chat-bar",onKeyDown:function(t){if("Enter"===t.key&&t.currentTarget.value){var n=t.currentTarget.value;t.currentTarget.value="",e.sendMessage({authorId:e.user.id,author:e.user,content:n})}}}),Object(j.jsx)("div",{title:"Send Message",className:"send-button",children:Object(j.jsx)("img",{src:E,className:"send-button-icon",alt:"Send Message"})})]})]})},C=function(e){var t=e.emitAction,n=e.owner,c=e.videoData;console.log(n);var a=Object(r.useState)(),s=Object(l.a)(a,2),o=s[0],i=s[1],u=Object(r.useRef)(null),d=function(){if(u.current){var e=u.current;t({type:"SET",property:"video",payload:{url:e.src,time:n?e.currentTime:c.time,paused:e.paused}})}},p=function(){if(u.current){var e=u.current,t=Math.abs(e.currentTime-c.time);console.log(e.currentTime,c.time),t>2&&(e.currentTime=c.time),c.paused&&!e.paused?e.pause():!c.paused&&e.paused&&e.play().then((function(){})).catch((function(){})),n&&!e.paused&&d()}};return Object(r.useEffect)((function(){o&&clearInterval(o),i(setInterval(p,1e3))}),[c]),Object(j.jsx)("video",{muted:!0,autoPlay:!0,controls:!0,style:{width:"100%",height:"100%"},ref:u,src:c.url,onPause:d,onPlay:d})},L=function(e,t){switch(t.type){case"ADD":return Object(w.a)(Object(w.a)({},e),{},Object(y.a)({},t.property,[].concat(Object(N.a)(e[t.property]),[t.payload])));case"REMOVE":return Object(w.a)(Object(w.a)({},e),{},Object(y.a)({},t.property,e[t.property].filter((function(e){return e.id!==t.payload.id}))));case"SET":return Object(w.a)(Object(w.a)({},e),{},Object(y.a)({},t.property,t.payload));default:return e}},R=function(e){var t=e.room,n=m(),c=Object(r.useState)(null),a=Object(l.a)(c,2),o=a[0],i=a[1],d=s.a.useReducer(L,e.room),p=Object(l.a)(d,2),b=p[0],h=p[1],O=function(e){null===o||void 0===o||o.emit("action",e),h(e)};return Object(r.useEffect)((function(){if(!o){var e=Object(z.io)("https://piper-326910.oa.r.appspot.com/",{query:{roomId:t.id}});i(e),e.on("connect",(function(){e.emit("join",{roomId:t.id,user:n.user}),e.on("action",(function(e){return h(e)}))}))}}),[n.user,t.id,o]),o?Object(j.jsxs)("div",{children:[Object(j.jsxs)("div",{className:"header",children:[Object(j.jsxs)("div",{className:"left",children:[Object(j.jsx)(u.b,{to:"/",className:"is-wrapper nuxt-link-exact-active nuxt-link-active",children:Object(j.jsx)("div",{className:"logo-small logo-mask"})}),Object(j.jsx)("h1",{className:"header-title",onClick:function(){var e;return null===(e=navigator.clipboard)||void 0===e?void 0:e.writeText(t.id)},style:{cursor:"pointer"},children:b.id})]}),Object(j.jsx)("div",{className:"right",children:b.users.map((function(e){return Object(j.jsx)("img",{src:e.avatar,alt:"Avatar of ".concat(e.name)})}))})]}),Object(j.jsxs)("div",{className:"content is-center",children:[Object(j.jsx)("div",{className:"room-wrapper",children:Object(j.jsx)("div",{className:"room",children:Object(j.jsx)("div",{className:"player-wrapper",style:{width:"78%",bottom:0},children:Object(j.jsx)(C,{videoData:Object(w.a)(Object(w.a)({},b.video),{},{url:"https://s4106-04.imovies.cc/video/imovie_hash_code/9/2020071010112589_high_ENG.mp4?md5=RyYOPQO_Q06TZ0vQZU_GDw&expires=1632386970&data=YTozOntzOjc6InVzZXJfaXAiO3M6MTU6IjEwOS4xNzIuMjMyLjE1MSI7czoxMDoidXNlcl9hZ2VudCI7czoxMTQ6Ik1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdpbjY0OyB4NjQpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS85My4wLjQ1NzcuODIgU2FmYXJpLzUzNy4zNiI7czo3OiJyZWZlcmVyIjtzOjIzOiJodHRwczovL3d3dy5pbW92aWVzLmNjLyI7fQ=="}),owner:b.ownerId===n.user.id,emitAction:O})})})}),Object(j.jsx)(M,{user:n.user,messages:b.messages,sendMessage:function(e){return O({type:"ADD",property:"messages",payload:e})}})]})]}):Object(j.jsx)(v,{children:"Loading..."})},D=function(e){var t=Object(r.useState)(),n=Object(l.a)(t,2),c=n[0],a=n[1];return Object(r.useEffect)((function(){S.a.get("/room/".concat(e.match.params.roomId)).then((function(e){return a(Object(w.a)({success:e.data.success},e.data.room))})).catch((function(e){return a(e.response?e.response.data:{id:"",error:e.message,success:!1,users:[],messages:[]})}))}),[e.match.params.roomId]),c?c.error?Object(j.jsxs)(v,{style:{fontSize:"3rem"},children:[c.error,Object(j.jsx)("br",{}),Object(j.jsx)(u.b,{to:"/",children:Object(j.jsx)(k,{children:"Go back to the home page"})})]}):Object(j.jsx)(R,{room:c}):Object(j.jsx)(v,{style:{fontSize:"3rem"},children:"Loading..."})},U=function(e){return Object(j.jsxs)("div",{className:"box option is-hoverable",onClick:e.onClick,children:[e.icon?Object(j.jsx)("img",{className:"icon",src:e.icon,alt:"Icon"}):null,Object(j.jsx)("h3",{className:"header",children:e.header}),Object(j.jsx)("p",{className:"description",children:e.description})]})},A=(n(332),n.p+"static/media/panel-arrow-right.488b9fc6.svg"),_=n.p+"static/media/add.0f7bde88.svg",J=function(){var e=Object(d.f)(),t=m();return Object(j.jsx)("div",{children:Object(j.jsx)("div",{className:"content is-center",children:Object(j.jsxs)("div",{className:"home",children:[Object(j.jsx)("h1",{className:"title",children:"Welcome Home"}),Object(j.jsxs)("p",{className:"subtitle",children:["It's never been easier to join or start a room with your friends.",Object(j.jsx)("br",{}),"Select an option below to get started:"]}),Object(j.jsxs)("div",{className:"options",children:[Object(j.jsx)(U,{icon:A,header:"Join a Room",description:"Received an invite link or an invite code for a room? Enter it here!"}),Object(j.jsx)(U,{icon:_,header:"Create a Room",description:"Need a room where you can watch anything with your friends? This is the place to go",onClick:function(){S.a.post("/room",{ownerId:t.user.id}).then((function(t){return e.push("/room/".concat(t.data.id))}))}})]})]})})})},G=function(){return Object(j.jsx)("div",{className:"App",children:Object(j.jsx)(b,{children:Object(j.jsx)(u.a,{children:Object(j.jsxs)(d.c,{children:[Object(j.jsx)(d.a,{exact:!0,path:"/",component:J}),Object(j.jsx)(d.a,{exact:!0,path:"/register",component:g}),Object(j.jsx)(d.a,{path:"/room/:roomId",component:D})]})})})})},V=(n(333),n(173));Object(V.config)(),S.a.defaults.baseURL="https://piper-326910.oa.r.appspot.com/",i.a.render(Object(j.jsx)(s.a.StrictMode,{children:Object(j.jsx)(G,{})}),document.getElementById("root"))}},[[337,1,2]]]);
//# sourceMappingURL=main.3bc085ae.chunk.js.map