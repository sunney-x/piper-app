(this.webpackJsonppiper=this.webpackJsonppiper||[]).push([[0],{183:function(e,t){},185:function(e,t){},196:function(e,t){},198:function(e,t){},225:function(e,t){},227:function(e,t){},228:function(e,t){},233:function(e,t){},235:function(e,t){},241:function(e,t){},243:function(e,t){},262:function(e,t){},274:function(e,t){},277:function(e,t){},332:function(e,t,c){},333:function(e,t,c){},337:function(e,t,c){"use strict";c.r(t);var n,a,s=c(1),r=c.n(s),o=c(166),i=c.n(o),d=c(21),l=c(5),u=c(23),j=(c(167),c(0)),m=Object(s.createContext)({user:{id:"",name:"",avatar:""},signup:function(){}}),b=function(){return Object(s.useContext)(m)},p=function(e){var t=h();return Object(j.jsx)(m.Provider,{value:t,children:e.children})},h=function(){var e=Object(s.useState)({id:"",name:"Guest",avatar:""}),t=Object(u.a)(e,2),c=t[0],n=t[1],a=function(e){var t=Math.random().toString(36).substr(2,9),c={id:t,name:e||"Guest",avatar:"https://avatars.dicebear.com/api/avataaars/".concat(e||t,".svg")};localStorage.setItem("user",JSON.stringify(c)),n(c)};return Object(s.useEffect)((function(){var e=localStorage.getItem("user");if(e){var t=JSON.parse(e);n(t)}else a()}),[]),{user:c,signup:a}},O=c.p+"static/media/checkmark.f9034358.svg",x=c(57),f=c(58),v=f.a.div(n||(n=Object(x.a)(["\n  margin: 0;\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n"]))),g=function(){var e,t=b();return Object(j.jsx)("div",{style:{fontSize:"1.5em",display:"flex"},children:Object(j.jsxs)(v,{style:{width:"80%",display:"flex",justifyContent:"center"},children:[Object(j.jsx)("input",{onChange:function(t){return e=t.target.value},type:"text",placeholder:"Username",style:{borderRadius:"50px",fontSize:"1em",padding:"15px",paddingLeft:"30px",outline:"none",border:"none"}}),Object(j.jsx)(d.c,{to:"/",children:Object(j.jsx)("button",{onClick:function(){return t.signup(e)},style:{marginLeft:"25px",borderRadius:"50px",width:"9em",height:"7em",border:"none",backgroundColor:"#41F900",cursor:"pointer"},children:Object(j.jsx)("img",{src:O,alt:"Checkmark"})})})]})})},N=c(37),y=c(174),S=c(19),w=c(36),_=c.n(w),E=c(172),T=f.a.button(a||(a=Object(x.a)(["\n  background-color: #f5f5f5;\n  border: 1px solid #e0e0e0;\n  border-radius: 15px;\n  color: #333;\n  cursor: pointer;\n  font-size: 20px;\n  font-weight: bold;\n  padding: 10px;\n  text-align: center;\n  text-decoration: none;\n  outline: 0;\n  -webkit-appearance: none;\n  -moz-appearance: none;\n  appearance: none;\n\n  &:hover {\n    background-color: #e5e5e5;\n    color: #333;\n  }\n"]))),k=c.p+"static/media/airplane.bf7fe13f.svg",C=function(e){var t=e.messages,c=t[0].author;return Object(j.jsxs)("div",{className:"grouped-chat-messages",children:[Object(j.jsx)("img",{src:null===c||void 0===c?void 0:c.avatar,className:"chat-messages-author-avatar owner"}),Object(j.jsxs)("div",{className:"chat-messages",children:[Object(j.jsx)("div",{className:"grouped-chat-messages-meta",children:Object(j.jsx)("p",{className:"chat-messages-author-name",children:t[0].author.name})}),t.map((function(e){return Object(j.jsx)("div",{className:"chat-message",children:Object(j.jsx)("p",{className:"chat-message-content",children:e.content})})}))]})]})},R=function(e){if(!e.messages)return Object(j.jsx)(j.Fragment,{});console.log("rendered");var t=function(e,t){for(var c=[],n=0,a=0;a<e.length;a++)a?e[a-1][t]!=e[a][t]&&(c[++n]=[]):c[n]=[],c[n].push(e[a]);return c}(e.messages,"authorId");return Object(j.jsxs)("div",{className:"chat",style:{width:"22%"},children:[Object(j.jsxs)("div",{className:"grouped-chat-messages-wrapper",style:{overflowY:"auto"},children:[t.map((function(e){return Object(j.jsx)(C,{messages:e})})),Object(j.jsx)("div",{className:"ps__rail-y",style:{top:"182px",right:"0px",height:"426px"},children:Object(j.jsx)("div",{className:"ps__thumb-y",tabIndex:0,style:{top:"128px",height:"298px"}})})]}),Object(j.jsxs)("div",{className:"chat-bar-wrapper",children:[Object(j.jsx)("input",{type:"text",placeholder:"Say something cool...",className:"chat-bar",onKeyDown:function(t){if("Enter"===t.key&&t.currentTarget.value){var c=t.currentTarget.value;t.currentTarget.value="",e.sendMessage({authorId:e.user.id,author:e.user,content:c})}}}),Object(j.jsx)("div",{title:"Send Message",className:"send-button",children:Object(j.jsx)("img",{src:k,className:"send-button-icon"})})]})]})},I=function(e){var t=e.emitAction,c=e.owner,n=e.videoData;console.log(c);var a=Object(s.useState)(),r=Object(u.a)(a,2),o=r[0],i=r[1],d=Object(s.useRef)(null),l=function(){if(d.current){var e=d.current;t({type:"SET",property:"video",payload:{url:e.src,time:c?e.currentTime:n.time,paused:e.paused}})}},m=function(){if(d.current){var e=d.current,t=Math.abs(e.currentTime-n.time);console.log(e.currentTime,n.time),t>2&&(e.currentTime=n.time),n.paused&&!e.paused?e.pause():!n.paused&&e.paused&&e.play().then((function(){})).catch((function(){})),c&&!e.paused&&l()}};return Object(s.useEffect)((function(){o&&clearInterval(o),i(setInterval(m,1e3))}),[n]),Object(j.jsx)("video",{muted:!0,autoPlay:!0,controls:!0,style:{width:"100%",height:"100%"},ref:d,src:n.url,onPause:l,onPlay:l})},P=function(e,t){switch(t.type){case"ADD":return Object(S.a)(Object(S.a)({},e),{},Object(N.a)({},t.property,[].concat(Object(y.a)(e[t.property]),[t.payload])));case"REMOVE":return Object(S.a)(Object(S.a)({},e),{},Object(N.a)({},t.property,e[t.property].filter((function(e){return e.id!==t.payload.id}))));case"SET":return Object(S.a)(Object(S.a)({},e),{},Object(N.a)({},t.property,t.payload));default:return e}},A=function(e){var t=e.room,c=b(),n=Object(s.useState)(null),a=Object(u.a)(n,2),o=a[0],i=a[1],l=r.a.useReducer(P,e.room),m=Object(u.a)(l,2),p=m[0],h=m[1],O=function(e){return null===o||void 0===o?void 0:o.emit("action",e)};return Object(s.useEffect)((function(){if(!o){var e=Object(E.io)(Object({NODE_ENV:"production",PUBLIC_URL:"/pipersync-client",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_API_URL||"http://localhost:5000",{query:{roomId:t.id}});i(e),e.on("connect",(function(){e.emit("join",{roomId:t.id,user:c.user}),e.on("action",(function(e){return h(e)}))}))}}),[c.user,t.id,o]),o?Object(j.jsxs)("div",{children:[Object(j.jsxs)("div",{className:"header",children:[Object(j.jsxs)("div",{className:"left",children:[Object(j.jsx)(d.c,{to:"/",className:"is-wrapper nuxt-link-exact-active nuxt-link-active",children:Object(j.jsx)("div",{className:"logo-small logo-mask"})}),Object(j.jsx)("h1",{className:"header-title",onClick:function(){var e;return null===(e=navigator.clipboard)||void 0===e?void 0:e.writeText(t.id)},style:{cursor:"pointer"},children:p.id})]}),Object(j.jsx)("div",{className:"right",children:p.users.map((function(e){return Object(j.jsx)("img",{src:e.avatar})}))})]}),Object(j.jsxs)("div",{className:"content is-center",children:[Object(j.jsx)("div",{className:"room-wrapper",children:Object(j.jsx)("div",{className:"room",children:Object(j.jsx)("div",{className:"player-wrapper",style:{width:"78%",bottom:0},children:Object(j.jsx)(I,{videoData:Object(S.a)(Object(S.a)({},p.video),{},{url:"https://api.imovies.cc/api/v1/movies/44822/files/1318315"}),owner:p.ownerId===c.user.id,emitAction:O})})})}),Object(j.jsx)(R,{user:c.user,messages:p.messages,sendMessage:function(e){return O({type:"ADD",property:"messages",payload:e})}})]})]}):Object(j.jsx)(v,{children:"Loading..."})},D=function(e){var t=Object(s.useState)(),c=Object(u.a)(t,2),n=c[0],a=c[1];return Object(s.useEffect)((function(){_.a.get("/room/".concat(e.match.params.roomId)).then((function(e){return a(Object(S.a)({success:e.data.success},e.data.room))})).catch((function(e){return a(e.response?e.response.data:{id:"",error:e.message,success:!1,users:[],messages:[]})}))}),[e.match.params.roomId]),n?n.error?Object(j.jsxs)(v,{style:{fontSize:"3rem"},children:[n.error,Object(j.jsx)("br",{}),Object(j.jsx)(d.c,{to:"/",children:Object(j.jsx)(T,{children:"Go back to the home page"})})]}):Object(j.jsx)(A,{room:n}):Object(j.jsx)(v,{style:{fontSize:"3rem"},children:"Loading..."})},L=function(e){return Object(j.jsxs)("div",{className:"box option is-hoverable",onClick:e.onClick,children:[e.icon?Object(j.jsx)("img",{className:"icon",src:e.icon}):null,Object(j.jsx)("h3",{className:"header",children:e.header}),Object(j.jsx)("p",{className:"description",children:e.description})]})},U=(c(332),c.p+"static/media/panel-arrow-right.488b9fc6.svg"),H=c.p+"static/media/add.0f7bde88.svg",K=function(){var e=Object(l.f)(),t=b();return Object(j.jsx)("div",{children:Object(j.jsx)("div",{className:"content is-center",children:Object(j.jsxs)("div",{className:"home",children:[Object(j.jsx)("h1",{className:"title",children:"Welcome Home"}),Object(j.jsxs)("p",{className:"subtitle",children:["It's never been easier to join or start a room with your friends.",Object(j.jsx)("br",{}),"Select an option below to get started:"]}),Object(j.jsxs)("div",{className:"options",children:[Object(j.jsx)(L,{icon:U,header:"Join a Room",description:"Received an invite link or an invite code for a room? Enter it here!"}),Object(j.jsx)(L,{icon:H,header:"Create a Room",description:"Need a room where you can watch anything with your friends? This is the place to go",onClick:function(){_.a.post("/room",{ownerId:t.user.id}).then((function(t){return e.push("/room/".concat(t.data.id))}))}})]})]})})})},M=function(){return Object(j.jsxs)("div",{className:"root",children:[Object(j.jsxs)("div",{className:"header",children:[Object(j.jsxs)("div",{className:"left",children:[Object(j.jsx)("a",{href:"/room","aria-current":"page",className:"is-wrapper nuxt-link-exact-active nuxt-link-active",children:Object(j.jsx)("div",{className:"logo-small logo-mask"})}),Object(j.jsx)("h1",{className:"header-title"})]}),Object(j.jsx)("div",{className:"right"})]}),Object(j.jsx)("div",{className:"content is-center",children:Object(j.jsx)("div",{className:"room-wrapper",children:Object(j.jsx)("div",{className:"room",children:Object(j.jsx)("video",{src:"/assets/7bff043b.mp4",preload:"",className:"is-placeholder"})})})})]})},W=function(){return Object(j.jsx)("div",{className:"App",children:Object(j.jsx)(p,{children:Object(j.jsx)(d.a,{children:Object(j.jsxs)(l.c,{children:[Object(j.jsx)(l.a,{exact:!0,path:"/",component:K}),Object(j.jsx)(l.a,{exact:!0,path:"/register",component:g}),Object(j.jsx)(l.a,{path:"/room/:roomId",component:D}),Object(j.jsx)(l.a,{path:"/_room",component:M}),Object(j.jsx)(l.a,{path:"/_home",component:K})]})})})})},z=(c(333),c(173));Object(z.config)(),_.a.defaults.baseURL=Object({NODE_ENV:"production",PUBLIC_URL:"/pipersync-client",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_API_URL||"http://localhost:5000",i.a.render(Object(j.jsx)(r.a.StrictMode,{children:Object(j.jsx)(d.b,{basename:"/",children:Object(j.jsx)(W,{})})}),document.getElementById("root"))}},[[337,1,2]]]);
//# sourceMappingURL=main.d53e3e32.chunk.js.map